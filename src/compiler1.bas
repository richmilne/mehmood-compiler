   1 REM XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
   2 GO TO VAL "900"
  10 DEF FN c(c)=VAL "48"+c+(VAL "7" AND c>VAL "9")
  11 LET a=LEN a$/w1
  12 LET c=INT (a/wd): LET d=a-c*wd: LET c$=CHR$ d+CHR$ c: RETURN
  15 DEF FN a(a)=PEEK a+wd*PEEK (a+w)
  16 GO SUB w7: LET R$=CHR$ PEEK P: LET VAR=(FN V(CODE R$)-VAL "97")*w1: LET P=P+w: GO SUB w8: IF PEEK P=CODE "$" THEN  LET x$="String functions not available": GO TO wf
  17 IF CHR$ PEEK p>="0" AND CHR$ PEEK P<="9" THEN  LET var=var+VAL "52": GO SUB w7
  19 RETURN
  20 LET P=P+w
  30 REM expression evaluator
  31 DEF FN v(v)=v+VAL "32"*(v<VAL "97")
  35 LET B$=M$
  37 LET d$=""
  40 LET e$=""
  41 REM each number
  49 LET o$=" "
  50 GO SUB w8: LET R$=CHR$ PEEK P
  51 LET r$=CHR$ PEEK p: IF r$=K$ OR r$=CHR$ VAL "203" OR (r$>"9" AND r$<"A") OR R$=CHR$ VAL "204" OR r$="=" OR r$="," OR R$=";" OR (r$>="{C7}" AND r$<="{C9}") THEN  RETURN
  52 IF r$>")" AND r$<"0" THEN  IF E$<>"" THEN  IF E$(1)<>CHR$ VAL "186" AND e$(1)>"z" THEN  RETURN
  53 IF r$>")" AND r$<"0" THEN  LET o$=R$: LET p=p+w: GO TO w6
  55 IF r$>=CHR$ VAL "165" AND R$<>CHR$ VAL "166" THEN  GO TO VAL "110"
  57 IF r$=")" THEN  IF e$<>"" THEN  LET p=p+w: RETURN
  58 IF r$=")" THEN  LET p=p+w: GO TO w6
  59 IF r$="(" THEN  GO TO VAL "111"
  60 IF r$>="A" THEN  GO TO VAL "90"
  63 LET p=p+w: IF PEEK p<>VAL "14" THEN  GO TO VAL "63"
  64 IF PEEK (p+w)<>PI-PI THEN  LET x$="Number out of range": GO TO wf
  70 LET p=p+VAL "3"
  72 LET b$=b$+"11"
  74 FOR p=p TO p+w: LET A=PEEK p: GO SUB wb
  76 LET b$=b$+c$
  77 NEXT p
  80 GO SUB w9
  83 GO SUB w7
  85 GO SUB w6
  90 LET v=FN v(CODE r$)
  91 GO SUB w7: LET A=(v-VAL "97")*w1+(VAL "52" AND CHR$ PEEK P>="0" AND CHR$ PEEK P<="9")
  93 GO SUB wb: LET B$=b$+"ED5B"+C$+N$: LET P=P-(CHR$ PEEK P<"0" OR CHR$ PEEK p>"9")
  94 GO TO VAL "80"
  95 LET P=P+w
  96 IF CHR$ PEEK p<=" " AND CHR$ PEEK p<>k$ THEN  GO TO w7
  97 RETURN
 100 IF o$=" " OR o$="+" THEN  LET B$=B$+"19": RETURN

 101 IF o$="-" THEN  LET B$=B$+"A7ED52": RETURN
 102 IF o$="*" THEN  LET B$=B$+"CDD05C": RETURN
 103 IF o$="." THEN  LET x$ = "Only intergers allowed.": GO TO wf
 104 IF o$<>"/" THEN  STOP
 105 LET B$ = B$+"CDE05C": RETURN
 110 IF R$=CHR$ VAL "189" OR R$=CHR$ VAL "186" THEN  LET P=P+w: GO TO w6
 112 PRINT TAB 1;R$;TAB VAL "8";"IN ";line
 114 GO SUB w7
 120 LET d$=o$+d$
 121 IF R$>=CHR$ VAL "217" AND R$<=CHR$ VAL "222" THEN  GO SUB VAL "183": LET P=P+w: GO TO w6
 122 IF r$<>CHR$ VAL "190" THEN  GO TO VAL "130"
 123 LET e$=CHR$ VAL "190"+e$
 125 LET b$=b$+"E5"+M$: GO SUB VAL "49"
 127 LET B$=B$+"5E1600E1"
 128 LET E$=E$(w1 TO ): LET o$=d$(w): LET d$=d$(w1 TO ): GO SUB w9: GO TO w6
 130 IF r$<>CHR$ 192 THEN  GO TO VAL "140"

 132 LET b$=b$+"E5CD": LET e$=CHR$ 192+e$
 133 GO SUB VAL "192"
 134 LET B$=B$+"E1"
 135 GO SUB w9: GO TO w6
 136 LET E$=CHR$ VAL "186"+E$: LET B$=B$+"E5"+M$: GO SUB w5: LET B$=B$+"EBE1": GO TO VAL "128"
 140 IF R$="(" THEN  GO TO VAL "136"
 141 IF r$<>CHR$ VAL "165" THEN  GO TO VAL "150"

 142 LET b$=b$+"E5210F00CD345DE1": GO TO wa
 150 IF r$<>CHR$ VAL "191" THEN  GO TO VAL "160"
 151 LET e$=CHR$ VAL "191"+e$: LET d$=o$+d$: LET b$=b$+"E5"+M$: GO SUB w5: LET B$=B$+"444DE1ED581600": GO TO wa
 160 IF r$<>CHR$ VAL "175" THEN  GO TO VAL "170"
 161 LET E$=E$+CHR$ VAL "175": IF PEEK P<>VAL "166" THEN  LET x$="CODE INKEY$ error": GO TO wf
 163 LET b$=b$+"FFED5B085C1600": LET P=P+w: GO TO wa

 164 LET E$=E$+CHR$ VAL "185": LET B$=B$+"E5"+M$: GO SUB w5: LET B$=B$+"CD345DE1"
 166 GO TO wa
 170 IF r$=CHR$ VAL "185" THEN  GO TO VAL "164"
 171 IF r$<>CHR$ VAL "171" THEN  GO TO VAL "177"
 172 LET b$=b$+"E5"+M$: LET P=P+w: LET E$=CHR$ VAL "171"+E$: GO SUB w5: LET B$=B$+"2929292929": LET P=P+w: GO SUB w5
 175 LET B$=B$+"110058195E1600E1": GO TO wa
 176 LET e$=e$+CHR$ VAL "169": LET B$=b$+"C5E5"+M$: GO SUB w7: GO SUB w5: LET B$=b$+"4D": LET B$=B$+M$: GO SUB w7: GO SUB w5: LET B$=b$+"45CDCE22CDD52D16005FE1C1": GO TO wa

 177 IF R$=CHR$ VAL "168" THEN  GO TO VAL "310"
 180 IF r$=CHR$ VAL "169" THEN  GO TO VAL "176"
 181 LET x$="Invalid function": GO TO wf
 183 LET s$=r$
 185 LET A=CODE R$-wc: GO SUB wb: LET A$=A$+"3E"+C$+"D7": GO SUB w4-(q$=r$): LET A$=A$+B$+P$: LET b$=M$: GO SUB w8: IF s$>=CHR$ VAL "221" THEN  LET b$="3A915C4FE60587B132915C"+B$: RETURN
 186 LET a$=a$+"3ABF5C328D5C":RETURN
 191 LET C=INT (A/VAL "16"): LET D=A-C*VAL "16": LET C=FN C(C): LET D=FN C(D): LET C$=CHR$ C+CHR$ D: RETURN

 192 GO SUB w8: LET r$=CHR$ PEEK p: IF R$<"0" OR R$>"9" THEN  LET x$="Only numbers allowed for  GO TO         GO SUB and USR ": GO TO wf
 195 LET P=P+VAL "1": IF PEEK P<>VAL "14" THEN  GO TO VAL "195"
 196 LET p=p+w2: LET a=PEEK p: IF e$="" THEN  RETURN
 198 GO SUB wb: LET b$=b$+c$: LET a=PEEK (p+w): GO SUB wb: LET b$=b$+c$: LET p=p+w1: RETURN
 201 IF P>=FN A(VAL "23627")-VAL "1" THEN  GO SUB VAL "830": PRINT TAB VAL "12";"COMPILED.": GO TO VAL "915"
 202 IF R$=k$ THEN  LET s=w: LET P=P+w: LET QQ=P: GO SUB VAL "11": LET l$=l$+CHR$ PEEK P+CHR$ PEEK (P+w)+C$: LET line=PEEK P*wd+PEEK (p+w): LET P=P+VAL "4"
 210 IF R$=":" THEN  LET s=s+w: LET P=P+w
 215 GO SUB w8
 220 POKE 23692,-1: LET R$=CHR$ PEEK P: LET q$=r$: PRINT r$;TAB 8;"IN ";line: IF R$=CHR$ VAL "241" THEN  GO TO VAL "600"
 221 IF R$=CHR$ VAL "250" THEN  GO TO VAL "620"
 222 IF R$=CHR$ VAL "245" THEN  GO TO VAL "700"
 223 IF R$=CHR$ VAL "246" THEN  GO TO VAL "760"
 224 IF R$=CHR$ VAL "244" OR R$=CHR$ VAL "223" THEN  GO TO VAL "765"
 225 IF R$>=CHR$ VAL "217" AND R$<=CHR$ VAL "222" THEN  GO SUB VAL "183": GO TO we
 227 IF R$=CHR$ VAL "215" OR R$=CHR$ VAL "252" THEN  GO TO VAL "770"
 228 IF R$=CHR$ VAL "251" THEN  LET A$=A$+"3A915C328F5CCDAF0D": GO TO VAL "300"
 229 IF R$=CHR$ VAL "236" OR R$=CHR$ VAL "237" THEN  LET A$=A$+("CD" AND R$=CHR$ VAL "237")+("C3" AND R$=CHR$ VAL "236"): LET C$="": GO TO VAL "645"
 230 IF R$=CHR$ VAL "231" THEN  GO TO VAL "772"
 231 IF R$=CHR$ VAL "226" THEN  LET A$=A$+"CF08": GO TO VAL "300"
 232 IF R$=CHR$ VAL "234" THEN  GO TO VAL "280"
 235 IF R$=CHR$ VAL "242" THEN  GO TO VAL "833"
 245 IF r$=CHR$ VAL "254" THEN  LET a$=a$+"C9": GO TO VAL "300"
 270 LET x$=r$+" INVALID Command": GO TO wf
 280 LET QQ=QQ+w2: LET A=PEEK QQ*wd+PEEK (QQ-w): LET P=QQ+A
 282 LET R$=K$: GO TO we
 299 LET x$="COMMAND"+R$+" INVALID": GO TO wf